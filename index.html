<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>hellonivaan</title>
        <script src= "https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
    </head>
    <body style = "margin:0; overflow: hidden; ">
        <script>
        let letters = Array.from("gamsamhellonivaan");
        let words = ["gam", "sam", "hello", "nivaan"];
        let letterStreams = [];
        let wordStreams= [];
        let symbols = "gam sam hello nivaan".split ("");
   //   let streams = [];
        let bg;
        let baseFont = 20;

        //nction setGradient(c1, c2){
        //  for(let y=0; y<height; y++){
         //     let inter = map(y, 0, height, 0, 1);
         //     let c = lerpColor(c1, c2, inter);
         //     stroke(c);
         //     line(0, y, width, y);
        //  }
    //  }

        function setup() {
            createCanvas(windowWidth,windowHeight);
            textFont('monospace');
            setFontByViewport();
            colorMode(HSB);
            fill(0, 255,120); 
            makeGradient();
            
            for (let i=0;  i <width /baseFont; i++){
                if (i % 2 == 0) letterStreams.push (new LetterStream(i * baseFont, random(-2000, 0)));
                else wordStreams.push(new WordStream(i * baseFont, random(-2000, 0)));
              //streams.push(new Stream(i * baseFont, random(-2000,0)));
            }
        }
        function draw() {
            image(bg, 0, 0, width,height);

            noStroke();
            fill(0, 35);
            rect(0, 0, width, height);

            fill(0, 255, 120);
            for (let s of letterStreams) s.update();
            for (let w of wordStreams) w.update();
          //for (let s of streams) s.update();
            
        }

        class LetterStream{
            constructor(x ,y){
                this.x=x; this.y=y;
                this.speed=random(4,8);
                this.hue=random(100,160);
            }
            update(){
                let ch = random(letters);
                text(ch,this.x, this.y);
                this.y += this.speed;
                if (this.y > height) this.y = random (-200,0);
                this.hue=random(100,160);
            }
        }

        class WordStream{
            constructor(x ,y){
                this.x=x; this.y=y;
                this.speed=random(2,6);
                this.chain= this.makeChain();
                this.hue=random(10,360);
            }
            makeChain(){
                let count=floor(random(2,5));
                let phrase ="";
                for (let i=0; i<count;i++) phrase += random(words)+"";
                return phrase.trim();
            }
            update(){
                let parts = this.chain.split("");
                for (let i=0; i<parts.length; i++){
                    fill((this.hue + i*15) % 360, 80, 100);
                    text(this.chain.split("")[i], this.x, this.y + i*baseFont);
                }
                this.y += this.speed;
                if (this.y > height) {
                    this.y = random(-200,0);
                    this.chain= this.makeChain();
                    this.hue=random(10,360);

                }
            }

        }


  //    class Stream {
     //     constructor(x, y){
     //         this.x = x;
      //         this.y = y;
      //         this.speed = random(3,8);
       //        this.word= random(symbols);
        //  }
          //update() {
          //    text(this.word, this.x, this.y);
           //   this.y += this.speed;
            //  if (this.y > height ) {
             //     this.y = random(-200, 0);
               //   this.word = random(symbols);

               //
          //}
        //

        //===function helpers===//
        function makeGradient(){
            bg = createGraphics(width, height);
            const c1 = color(0, 15, 30);
            const c2 = color(0, 0, 0);
            const c3 = color(25, 0, 45);
            const c4 = color(0, 25, 50);
            const c5 = color(25, 15, 0);

            for (let y = 0; y < height ; y++){
                const t = map(y, 0, height, 0, 1);
                const c = lerpColor(c1, c2, c3, c4, c5, t);
                bg.stroke(c);
                bg.line(0, y, width, y);
            }
        }
        
        function setFontByViewport(){
            baseFont = round(constrain(map(min(width, height), 360, 1440, 16, 28), 16, 28));
            textSize(baseFont);
        }
        function windowResized(){
            resizeCanvas(windowWidth, windowHeight);
            setFontByViewport();
            makeGradient();
            streams =[];
            for (let i = 0; i < width / baseFont; i++){
                streams.push(new Stream(i * baseFont, random(-2000, 0)));
            }
        }
        </script>
    </body>

</html>